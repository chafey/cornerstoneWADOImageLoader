{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 8c8097b6499c6587e9a7","webpack:///external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}","webpack:///external {\"commonjs\":\"cornerstone-core\",\"commonjs2\":\"cornerstone-core\",\"amd\":\"cornerstone-core\",\"root\":\"cornerstone\"}","webpack:///./imageLoader/internal/index.js","webpack:///./version.js","webpack:///./imageLoader/wadors/metaData/getValue.js","webpack:///./imageLoader/wadouri/parseImageId.js","webpack:///external {\"commonjs\":\"dicom-parser\",\"commonjs2\":\"dicom-parser\",\"amd\":\"dicom-parser\",\"root\":\"dicomParser\"}","webpack:///./imageLoader/createImage.js","webpack:///./imageLoader/wadors/metaDataManager.js","webpack:///./imageLoader/wadouri/dataSetCacheManager.js","webpack:///./imageLoader/colorSpaceConverters/index.js","webpack:///./imageLoader/convertColorSpace.js","webpack:///./imageLoader/decodeImageFrame.js","webpack:///./imageLoader/decodeJPEGBaseline8BitColor.js","webpack:///./imageLoader/events.js","webpack:///./imageLoader/getImageFrame.js","webpack:///./imageLoader/getMinMax.js","webpack:///./imageLoader/isColorImage.js","webpack:///./imageLoader/isJPEGBaseline8BitColor.js","webpack:///./imageLoader/webWorkerManager.js","webpack:///./imageLoader/internal/options.js","webpack:///./imageLoader/wadors/findIndexOfString.js","webpack:///./imageLoader/wadors/getPixelData.js","webpack:///./imageLoader/wadors/metaData/getNumberValue.js","webpack:///./imageLoader/wadors/metaData/getNumberValues.js","webpack:///./imageLoader/wadouri/fileManager.js","webpack:///./imageLoader/wadouri/getEncapsulatedImageFrame.js","webpack:///./imageLoader/wadouri/getUncompressedImageFrame.js","webpack:///./imageLoader/wadouri/loadFileRequest.js","webpack:///./imageLoader/wadouri/metaData/getImagePixelModule.js","webpack:///./imageLoader/wadouri/metaData/getLUTs.js","webpack:///./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js","webpack:///./imageLoader/wadouri/metaData/getNumberValues.js","webpack:///./imageLoader/wadouri/unpackBinaryFrame.js","webpack:///./imageLoader/configure.js","webpack:///./imageLoader/wadors/index.js","webpack:///./imageLoader/wadouri/index.js","webpack:///./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js","webpack:///./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js","webpack:///./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js","webpack:///./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js","webpack:///./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js","webpack:///./imageLoader/index.js","webpack:///./imageLoader/internal/xhrRequest.js","webpack:///./imageLoader/wadors/loadImage.js","webpack:///./imageLoader/wadors/metaData/getNumberString.js","webpack:///./imageLoader/wadors/metaData/index.js","webpack:///./imageLoader/wadors/metaData/metaDataProvider.js","webpack:///./imageLoader/wadouri/loadImage.js","webpack:///./imageLoader/wadouri/metaData/index.js","webpack:///./imageLoader/wadouri/metaData/metaDataProvider.js"],"names":["internal","xhrRequest","setOptions","getOptions","getValue","element","index","defaultValue","Value","length","parseImageId","imageId","firstColonIndex","indexOf","url","substring","frameIndex","frame","frameStr","substr","parseInt","scheme","cornerstone","lastImageIdDrawn","isModalityLUTForDisplay","sopClassUid","setPixelDataType","imageFrame","bitsAllocated","pixelRepresentation","pixelData","Uint16Array","Int16Array","Uint8Array","createImage","transferSyntax","options","canvas","document","createElement","deferred","Deferred","decodePromise","then","imagePlaneModule","metaData","get","voiLutModule","modalityLutModule","sopCommonModule","isColorImage","photometricInterpretation","height","rows","width","columns","context","getContext","imageData","createImageData","data","image","color","columnPixelSpacing","pixelSpacing","undefined","intercept","rescaleIntercept","invert","minPixelValue","smallestPixelValue","maxPixelValue","largestPixelValue","render","rowPixelSpacing","sizeInBytes","slope","rescaleSlope","windowCenter","windowWidth","decodeTimeInMS","getPixelData","renderColorImage","getCanvas","putImageData","renderGrayscaleImage","minMax","min","max","modalityLUTSequence","sopClassUID","modalityLUT","voiLUTSequence","voiLUT","maxVoi","minVoi","resolve","promise","imageIds","add","metadata","remove","purge","dicomParser","loadedDataSets","promises","isLoaded","uri","dataSet","load","loadRequest","alreadyLoadedpromise","cacheCount","loadDeferred","dicomPart10AsArrayBuffer","byteArray","parseDicom","error","reject","trigger","action","always","unload","default","convertColorSpace","convertRGB","rgbaBuffer","planarConfiguration","convertYBRFull","Error","addDecodeTask","priority","transferList","transferPixelData","buffer","addTask","decodeImageFrame","samplesPerPixel","arrayBufferToString","binaryToString","String","fromCharCode","apply","Array","prototype","slice","binary","decodeURIComponent","escape","_error","URIError","decodeJPEGBaseline8BitColor","start","Date","getTime","imgBlob","Blob","type","r","FileReader","readAsBinaryString","readAsArrayBuffer","onload","img","Image","drawImage","getImageData","end","onerror","src","window","btoa","result","events","name","getImageFrame","imagePixelModule","redPaletteColorLookupTableDescriptor","greenPaletteColorLookupTableDescriptor","bluePaletteColorLookupTableDescriptor","redPaletteColorLookupTableData","greenPaletteColorLookupTableData","bluePaletteColorLookupTableData","getMinMax","storedPixelData","storedPixel","numPixels","Math","photoMetricInterpretation","isJPEGBaseline8BitColor","nextTaskId","tasks","webWorkers","defaultConfig","maxWebWorkers","navigator","hardwareConcurrency","startWebWorkersOnDemand","webWorkerPath","webWorkerTaskPaths","taskConfiguration","decodeTask","loadCodecsOnStartup","initializeCodecsOnStartup","codecsPath","usePDFJS","config","statistics","numWebWorkers","numTasksQueued","numTasksExecuting","numTasksCompleted","totalTaskTimeInMS","totalTimeDelayedInMS","startTaskOnWebWorker","i","status","task","shift","added","worker","postMessage","taskType","workerIndex","spawnWebWorker","handleMessageFromWorker","msg","Worker","push","addEventListener","initialize","configObject","loadWebWorkerTask","sourcePath","taskConfig","Object","assign","taskId","splice","setTaskPriority","cancelTask","reason","getStatistics","beforeSend","imageCreated","newOptions","checkToken","token","dataOffset","endIndex","stringToUint8Array","str","uint","j","charCodeAt","findIndexOfString","offset","findBoundary","header","findContentType","trim","uint8ArrayToString","mediaType","headers","accept","loadPromise","imageFrameAsArrayBuffer","response","tokenIndex","split","boundary","contentType","getNumberValue","value","parseFloat","getNumberValues","minimumLength","values","files","file","fileIndex","getEncapsulatedImageFrame","framesAreFragmented","numberOfFrames","intString","pixelDataElement","elements","x7fe00010","fragments","basicOffsetTable","readEncapsulatedImageFrame","createJPEGBasicOffsetTable","readEncapsulatedPixelDataFromFragments","getUncompressedImageFrame","uint16","pixelDataOffset","pixelsPerFrame","frameOffset","loadFileRequest","parsedImageId","fileReader","e","target","getLutDescriptor","tag","getLutData","lutDataSet","lutDescriptor","lut","lutData","numLutEntries","populatePaletteColorLut","x00281101","populateSmallestLargestPixelValues","int16","getImagePixelModule","string","bitsStored","highBit","pixelAspectRatio","getLUT","numLUTEntries","firstValueMapped","numBitsPerEntry","id","getLUTs","lutSequence","items","luts","getMinStoredPixelValue","getModalityLUTOutputPixelRepresentation","floatString","minStoredPixelValue","minModalityLutValue","x00283000","valueAsString","isBitSet","byte","bitPos","unpackBinaryFrame","bytePos","floor","configure","getNumberString","metaDataProvider","loadImage","metaDataManager","dataSetCacheManager","fileManager","palIndex","rgbaIndex","rData","gData","bData","len","rgbIndex","rIndex","gIndex","bIndex","ybrIndex","y","cb","cr","yIndex","cbIndex","crIndex","xhr","XMLHttpRequest","open","responseType","keys","forEach","key","setRequestHeader","onreadystatechange","readyState","onprogress","oProgress","lengthComputable","loaded","total","percentComplete","round","send","getTransferSyntaxForContentType","imagePromise","loadTimeInMS","fail","registerImageLoader","modality","seriesInstanceUID","seriesNumber","studyInstanceUID","seriesDate","parseDA","seriesTime","parseTM","patientAge","patientSize","patientWeight","imageOrientationPatient","imagePositionPatient","sliceThickness","sliceLocation","rescaleType","sopInstanceUID","radiopharmaceuticalInfo","radiopharmaceuticalStartTime","radionuclideTotalDose","radionuclideHalfLife","addProvider","addDecache","decache","encapsulatedPixelData","loadImageFromPromise","dataSetPromise","sharedCacheKey","loadEnd","totalTimeInMS","getLoaderForScheme","loader","frameOfReferenceUID","modalityLUTOutputPixelRepresentation","x00283010","x00540016","firstRadiopharmaceuticalInfoDataSet"],"mappings":"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","file":"cornerstoneWADOImageLoader.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"cornerstone-core\"), require(\"dicom-parser\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"cornerstoneWADOImageLoader\", [\"jquery\", \"cornerstone-core\", \"dicom-parser\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cornerstoneWADOImageLoader\"] = factory(require(\"jquery\"), require(\"cornerstone-core\"), require(\"dicom-parser\"));\n\telse\n\t\troot[\"cornerstoneWADOImageLoader\"] = factory(root[\"$\"], root[\"cornerstone\"], root[\"dicomParser\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_6__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 46);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8c8097b6499c6587e9a7","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}\n// module id = 0\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"cornerstone-core\",\"commonjs2\":\"cornerstone-core\",\"amd\":\"cornerstone-core\",\"root\":\"cornerstone\"}\n// module id = 1\n// module chunks = 0","import { default as xhrRequest } from './xhrRequest';\r\nimport { setOptions, getOptions } from './options';\r\n\r\nconst internal = {\r\n  xhrRequest,\r\n  setOptions,\r\n  getOptions\r\n};\r\n\r\nexport { setOptions, getOptions, xhrRequest, internal };\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/internal/index.js","export default '0.14.6';\n\n\n\n// WEBPACK FOOTER //\n// ./version.js","\r\n\r\n/**\r\n * Returns the raw value\r\n *\r\n * @param element - The javascript object for the specified element in the metadata\r\n * @param [index] - the index of the value in a multi-valued element, default is 0\r\n * @param [defaultValue] - The default value to return if the element does not exist\r\n * @returns {*}\r\n */\r\nfunction getValue (element, index, defaultValue) {\r\n  index = index || 0;\r\n  if (!element) {\r\n    return defaultValue;\r\n  }\r\n  // Value is not present if the attribute has a zero length value\r\n  if (!element.Value) {\r\n    return defaultValue;\r\n  }\r\n  // make sure we have the specified index\r\n  if (element.Value.length <= index) {\r\n    return defaultValue;\r\n  }\r\n\r\n  return element.Value[index];\r\n}\r\n\r\nexport default getValue;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getValue.js","\r\n\r\nfunction parseImageId (imageId) {\r\n  // build a url by parsing out the url scheme and frame index from the imageId\r\n  const firstColonIndex = imageId.indexOf(':');\r\n  let url = imageId.substring(firstColonIndex + 1);\r\n  const frameIndex = url.indexOf('frame=');\r\n  let frame;\r\n\r\n  if (frameIndex !== -1) {\r\n    const frameStr = url.substr(frameIndex + 6);\r\n\r\n    frame = parseInt(frameStr, 10);\r\n    url = url.substr(0, frameIndex - 1);\r\n  }\r\n\r\n  return {\r\n    scheme: imageId.substr(0, firstColonIndex),\r\n    url,\r\n    frame\r\n  };\r\n}\r\n\r\nexport default parseImageId;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/parseImageId.js","module.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"dicom-parser\",\"commonjs2\":\"dicom-parser\",\"amd\":\"dicom-parser\",\"root\":\"dicomParser\"}\n// module id = 6\n// module chunks = 0","import $ from 'jquery';\r\nimport getImageFrame from './getImageFrame';\r\nimport decodeImageFrame from './decodeImageFrame';\r\nimport { default as isColorImageFn } from './isColorImage';\r\nimport convertColorSpace from './convertColorSpace';\r\nimport getMinMax from './getMinMax';\r\nimport isJPEGBaseline8BitColor from './isJPEGBaseline8BitColor';\r\nimport * as cornerstone from 'cornerstone-core';\r\n\r\nlet lastImageIdDrawn = '';\r\n\r\nfunction isModalityLUTForDisplay (sopClassUid) {\r\n  // special case for XA and XRF\r\n  // https://groups.google.com/forum/#!searchin/comp.protocols.dicom/Modality$20LUT$20XA/comp.protocols.dicom/UBxhOZ2anJ0/D0R_QP8V2wIJ\r\n  return sopClassUid !== '1.2.840.10008.5.1.4.1.1.12.1' && // XA\r\n         sopClassUid !== '1.2.840.10008.5.1.4.1.1.12.2.1'; // XRF\r\n}\r\n\r\n/**\r\n * Helper function to set pixel data to the right typed array.  This is needed because web workers\r\n * can transfer array buffers but not typed arrays\r\n * @param imageFrame\r\n */\r\nfunction setPixelDataType (imageFrame) {\r\n  if (imageFrame.bitsAllocated === 16) {\r\n    if (imageFrame.pixelRepresentation === 0) {\r\n      imageFrame.pixelData = new Uint16Array(imageFrame.pixelData);\r\n    } else {\r\n      imageFrame.pixelData = new Int16Array(imageFrame.pixelData);\r\n    }\r\n  } else {\r\n    imageFrame.pixelData = new Uint8Array(imageFrame.pixelData);\r\n  }\r\n}\r\n\r\nfunction createImage (imageId, pixelData, transferSyntax, options) {\r\n  const canvas = document.createElement('canvas');\r\n  const deferred = $.Deferred();\r\n  const imageFrame = getImageFrame(imageId);\r\n  const decodePromise = decodeImageFrame(imageFrame, transferSyntax, pixelData, canvas, options);\r\n\r\n  decodePromise.then(function (imageFrame) {\r\n    // var imagePixelModule = metaDataProvider('imagePixelModule', imageId);\r\n    const imagePlaneModule = cornerstone.metaData.get('imagePlaneModule', imageId);\r\n    const voiLutModule = cornerstone.metaData.get('voiLutModule', imageId);\r\n    const modalityLutModule = cornerstone.metaData.get('modalityLutModule', imageId);\r\n    const sopCommonModule = cornerstone.metaData.get('sopCommonModule', imageId);\r\n    const isColorImage = isColorImageFn(imageFrame.photometricInterpretation);\r\n\r\n    // JPEGBaseline (8 bits) is already returning the pixel data in the right format (rgba)\r\n    // because it's using a canvas to load and decode images.\r\n    if (!isJPEGBaseline8BitColor(imageFrame, transferSyntax)) {\r\n      setPixelDataType(imageFrame);\r\n\r\n      // convert color space\r\n      if (isColorImage) {\r\n        // setup the canvas context\r\n        canvas.height = imageFrame.rows;\r\n        canvas.width = imageFrame.columns;\r\n\r\n        const context = canvas.getContext('2d');\r\n        const imageData = context.createImageData(imageFrame.columns, imageFrame.rows);\r\n\r\n        convertColorSpace(imageFrame, imageData);\r\n        imageFrame.imageData = imageData;\r\n        imageFrame.pixelData = imageData.data;\r\n      }\r\n    }\r\n\r\n    const image = {\r\n      imageId,\r\n      color: isColorImage,\r\n      columnPixelSpacing: imagePlaneModule.pixelSpacing ? imagePlaneModule.pixelSpacing[1] : undefined,\r\n      columns: imageFrame.columns,\r\n      height: imageFrame.rows,\r\n      intercept: modalityLutModule.rescaleIntercept ? modalityLutModule.rescaleIntercept : 0,\r\n      invert: imageFrame.photometricInterpretation === 'MONOCHROME1',\r\n      minPixelValue: imageFrame.smallestPixelValue,\r\n      maxPixelValue: imageFrame.largestPixelValue,\r\n      render: undefined, // set below\r\n      rowPixelSpacing: imagePlaneModule.pixelSpacing ? imagePlaneModule.pixelSpacing[0] : undefined,\r\n      rows: imageFrame.rows,\r\n      sizeInBytes: imageFrame.pixelData.length,\r\n      slope: modalityLutModule.rescaleSlope ? modalityLutModule.rescaleSlope : 1,\r\n      width: imageFrame.columns,\r\n      windowCenter: voiLutModule.windowCenter ? voiLutModule.windowCenter[0] : undefined,\r\n      windowWidth: voiLutModule.windowWidth ? voiLutModule.windowWidth[0] : undefined,\r\n      decodeTimeInMS: imageFrame.decodeTimeInMS\r\n    };\r\n\r\n    // add function to return pixel data\r\n    image.getPixelData = () => imageFrame.pixelData;\r\n\r\n    // Setup the renderer\r\n    if (image.color) {\r\n      image.render = cornerstone.renderColorImage;\r\n      image.getCanvas = function () {\r\n        if (lastImageIdDrawn === imageId) {\r\n          return canvas;\r\n        }\r\n\r\n        canvas.height = image.rows;\r\n        canvas.width = image.columns;\r\n        const context = canvas.getContext('2d');\r\n\r\n        context.putImageData(imageFrame.imageData, 0, 0);\r\n        lastImageIdDrawn = imageId;\r\n\r\n        return canvas;\r\n      };\r\n\r\n    } else {\r\n      image.render = cornerstone.renderGrayscaleImage;\r\n    }\r\n\r\n    // calculate min/max if not supplied\r\n    if (image.minPixelValue === undefined || image.maxPixelValue === undefined) {\r\n      const minMax = getMinMax(imageFrame.pixelData);\r\n\r\n      image.minPixelValue = minMax.min;\r\n      image.maxPixelValue = minMax.max;\r\n    }\r\n\r\n    // Modality LUT\r\n    if (modalityLutModule.modalityLUTSequence &&\r\n      modalityLutModule.modalityLUTSequence.length > 0 &&\r\n      isModalityLUTForDisplay(sopCommonModule.sopClassUID)) {\r\n      image.modalityLUT = modalityLutModule.modalityLUTSequence[0];\r\n    }\r\n\r\n    // VOI LUT\r\n    if (voiLutModule.voiLUTSequence &&\r\n      voiLutModule.voiLUTSequence.length > 0) {\r\n      image.voiLUT = voiLutModule.voiLUTSequence[0];\r\n    }\r\n\r\n    // set the ww/wc to cover the dynamic range of the image if no values are supplied\r\n    if (image.windowCenter === undefined || image.windowWidth === undefined) {\r\n      if (image.color) {\r\n        image.windowWidth = 255;\r\n        image.windowCenter = 128;\r\n      } else {\r\n        const maxVoi = image.maxPixelValue * image.slope + image.intercept;\r\n        const minVoi = image.minPixelValue * image.slope + image.intercept;\r\n\r\n        image.windowWidth = maxVoi - minVoi;\r\n        image.windowCenter = (maxVoi + minVoi) / 2;\r\n      }\r\n    }\r\n    deferred.resolve(image);\r\n  });\r\n\r\n  return deferred.promise();\r\n}\r\n\r\nexport default createImage;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/createImage.js","\r\n\r\nlet imageIds = [];\r\n\r\nfunction add (imageId, metadata) {\r\n  imageIds[imageId] = metadata;\r\n}\r\n\r\nfunction get (imageId) {\r\n  return imageIds[imageId];\r\n}\r\n\r\nfunction remove (imageId) {\r\n  imageIds[imageId] = undefined;\r\n}\r\n\r\nfunction purge () {\r\n  imageIds = [];\r\n}\r\n\r\nexport default {\r\n  add,\r\n  get,\r\n  remove,\r\n  purge\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaDataManager.js","import $ from 'jquery';\nimport * as dicomParser from 'dicom-parser';\nimport { xhrRequest } from '../internal';\nimport events from '../events.js';\n\n/**\n * This object supports loading of DICOM P10 dataset from a uri and caching it so it can be accessed\n * by the caller.  This allows a caller to access the datasets without having to go through cornerstone's\n * image loader mechanism.  One reason a caller may need to do this is to determine the number of frames\n * in a multiframe sop instance so it can create the imageId's correctly.\n */\nlet loadedDataSets = {};\nlet promises = {};\n\n// returns true if the wadouri for the specified index has been loaded\nfunction isLoaded (uri) {\n  return loadedDataSets[uri] !== undefined;\n}\n\nfunction get (uri) {\n  // if already loaded return it right away\n  if (!loadedDataSets[uri]) {\n    return;\n  }\n\n  return loadedDataSets[uri].dataSet;\n}\n\n\n  // loads the dicom dataset from the wadouri sp\nfunction load (uri, loadRequest, imageId) {\n  loadRequest = loadRequest || xhrRequest;\n\n  // if already loaded return it right away\n  if (loadedDataSets[uri]) {\n    // console.log('using loaded dataset ' + uri);\n    const alreadyLoadedpromise = $.Deferred();\n\n    loadedDataSets[uri].cacheCount++;\n    alreadyLoadedpromise.resolve(loadedDataSets[uri].dataSet);\n\n    return alreadyLoadedpromise;\n  }\n\n  // if we are currently loading this uri, return its promise\n  if (promises[uri]) {\n    // console.log('returning existing load promise for ' + uri);\n    return promises[uri];\n  }\n\n  // console.log('loading ' + uri);\n\n  // This uri is not loaded or being loaded, load it via an xhrRequest\n  const promise = loadRequest(uri, imageId);\n\n  // handle success and failure of the XHR request load\n  const loadDeferred = $.Deferred();\n\n  promise.then(function (dicomPart10AsArrayBuffer/* , xhr*/) {\n    const byteArray = new Uint8Array(dicomPart10AsArrayBuffer);\n\n    // Reject the promise if parsing the dicom file fails\n    let dataSet;\n\n    try {\n      dataSet = dicomParser.parseDicom(byteArray);\n    } catch (error) {\n      loadDeferred.reject(error);\n\n      return;\n    }\n\n    loadedDataSets[uri] = {\n      dataSet,\n      cacheCount: 1\n    };\n    $(events).trigger('DataSetsCacheChanged', {\n      uri,\n      action: 'loaded',\n      dataSet: loadedDataSets[uri].dataSet\n    });\n\n    loadDeferred.resolve(dataSet);\n    // done loading, remove the promise\n    delete promises[uri];\n  }).always(function () {\n      // error thrown, remove the promise\n    delete promises[uri];\n  });\n\n  promises[uri] = loadDeferred;\n\n  return loadDeferred;\n}\n\n// remove the cached/loaded dicom dataset for the specified wadouri to free up memory\nfunction unload (uri) {\n  // console.log('unload for ' + uri);\n  if (loadedDataSets[uri]) {\n    loadedDataSets[uri].cacheCount--;\n    if (loadedDataSets[uri].cacheCount === 0) {\n      // console.log('removing loaded dataset for ' + uri);\n      $(events).trigger('DataSetsCacheChanged', {\n        uri,\n        action: 'unloaded',\n        dataSet: loadedDataSets[uri].dataSet\n      });\n      delete loadedDataSets[uri];\n    }\n  }\n}\n\n// removes all cached datasets from memory\nfunction purge () {\n  loadedDataSets = {};\n  promises = {};\n}\n\nexport default {\n  isLoaded,\n  load,\n  unload,\n  purge,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/dataSetCacheManager.js","export { default as convertRGBColorByPixel } from './convertRGBColorByPixel';\r\nexport { default as convertRGBColorByPlane } from './convertRGBColorByPlane';\r\nexport { default as convertYBRFullByPixel } from './convertYBRFullByPixel';\r\nexport { default as convertYBRFullByPlane } from './convertYBRFullByPlane';\r\nexport { default as convertPALETTECOLOR } from './convertPALETTECOLOR';\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/index.js","import { convertRGBColorByPixel, convertRGBColorByPlane,\r\n         convertYBRFullByPixel, convertYBRFullByPlane,\r\n         convertPALETTECOLOR } from './colorSpaceConverters';\r\n\r\nfunction convertRGB (imageFrame, rgbaBuffer) {\r\n  if (imageFrame.planarConfiguration === 0) {\r\n    convertRGBColorByPixel(imageFrame.pixelData, rgbaBuffer);\r\n  } else {\r\n    convertRGBColorByPlane(imageFrame.pixelData, rgbaBuffer);\r\n  }\r\n}\r\n\r\nfunction convertYBRFull (imageFrame, rgbaBuffer) {\r\n  if (imageFrame.planarConfiguration === 0) {\r\n    convertYBRFullByPixel(imageFrame.pixelData, rgbaBuffer);\r\n  } else {\r\n    convertYBRFullByPlane(imageFrame.pixelData, rgbaBuffer);\r\n  }\r\n}\r\n\r\nexport default function convertColorSpace (imageFrame, imageData) {\r\n  const rgbaBuffer = imageData.data;\r\n  // convert based on the photometric interpretation\r\n\r\n  if (imageFrame.photometricInterpretation === 'RGB') {\r\n    convertRGB(imageFrame, rgbaBuffer);\r\n  } else if (imageFrame.photometricInterpretation === 'YBR_RCT') {\r\n    convertRGB(imageFrame, rgbaBuffer);\r\n  } else if (imageFrame.photometricInterpretation === 'YBR_ICT') {\r\n    convertRGB(imageFrame, rgbaBuffer);\r\n  } else if (imageFrame.photometricInterpretation === 'PALETTE COLOR') {\r\n    convertPALETTECOLOR(imageFrame, rgbaBuffer);\r\n  } else if (imageFrame.photometricInterpretation === 'YBR_FULL_422') {\r\n    convertRGB(imageFrame, rgbaBuffer);\r\n  } else if (imageFrame.photometricInterpretation === 'YBR_FULL') {\r\n    convertYBRFull(imageFrame, rgbaBuffer);\r\n  } else {\r\n    throw new Error(`No color space conversion for photometric interpretation ${imageFrame.photometricInterpretation}`);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/convertColorSpace.js","import webWorkerManager from './webWorkerManager';\r\nimport decodeJPEGBaseline8BitColor from './decodeJPEGBaseline8BitColor';\r\n\r\nfunction addDecodeTask (imageFrame, transferSyntax, pixelData, options) {\r\n  const priority = options.priority || undefined;\r\n  const transferList = options.transferPixelData ? [pixelData.buffer] : undefined;\r\n\r\n  return webWorkerManager.addTask(\r\n    'decodeTask',\r\n    {\r\n      imageFrame,\r\n      transferSyntax,\r\n      pixelData,\r\n      options\r\n    }, priority, transferList).promise;\r\n}\r\n\r\nfunction decodeImageFrame (imageFrame, transferSyntax, pixelData, canvas, options) {\r\n  options = options || {};\r\n\r\n  // TODO: Turn this into a switch statement instead\r\n  if (transferSyntax === '1.2.840.10008.1.2') {\r\n    // Implicit VR Little Endian\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.1') {\r\n    // Explicit VR Little Endian\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.2') {\r\n    // Explicit VR Big Endian (retired)\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.1.99') {\r\n    // Deflate transfer syntax (deflated by dicomParser)\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.5') {\r\n    // RLE Lossless\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.50') {\r\n    // JPEG Baseline lossy process 1 (8 bit)\r\n\r\n    // Handle 8-bit JPEG Baseline color images using the browser's built-in\r\n    // JPEG decoding\r\n    if (imageFrame.bitsAllocated === 8 &&\r\n       (imageFrame.samplesPerPixel === 3 || imageFrame.samplesPerPixel === 4)) {\r\n      return decodeJPEGBaseline8BitColor(imageFrame, pixelData, canvas);\r\n    }\r\n\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.51') {\r\n    // JPEG Baseline lossy process 2 & 4 (12 bit)\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.57') {\r\n    // JPEG Lossless, Nonhierarchical (Processes 14)\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.70') {\r\n    // JPEG Lossless, Nonhierarchical (Processes 14 [Selection 1])\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.80') {\r\n    // JPEG-LS Lossless Image Compression\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.81') {\r\n    // JPEG-LS Lossy (Near-Lossless) Image Compression\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.90') {\r\n    // JPEG 2000 Lossless\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.91') {\r\n    // JPEG 2000 Lossy\r\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\r\n  }\r\n\r\n  /* Don't know if these work...\r\n   // JPEG 2000 Part 2 Multicomponent Image Compression (Lossless Only)\r\n   else if(transferSyntax === \"1.2.840.10008.1.2.4.92\")\r\n   {\r\n   return cornerstoneWADOImageLoader.decodeJPEG2000(dataSet, frame);\r\n   }\r\n   // JPEG 2000 Part 2 Multicomponent Image Compression\r\n   else if(transferSyntax === \"1.2.840.10008.1.2.4.93\")\r\n   {\r\n   return cornerstoneWADOImageLoader.decodeJPEG2000(dataSet, frame);\r\n   }\r\n   */\r\n\r\n  throw new Error(`No decoder for transfer syntax ${transferSyntax}`);\r\n}\r\n\r\nexport default decodeImageFrame;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/decodeImageFrame.js","import $ from 'jquery';\r\n\r\n/**\r\n * Special decoder for 8 bit jpeg that leverages the browser's built in JPEG decoder for increased performance\r\n */\r\n\r\nfunction arrayBufferToString (buffer) {\r\n  return binaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(new Uint8Array(buffer))));\r\n}\r\n\r\nfunction binaryToString (binary) {\r\n  let error;\r\n\r\n  try {\r\n    return decodeURIComponent(escape(binary));\r\n  } catch (_error) {\r\n    error = _error;\r\n    if (error instanceof URIError) {\r\n      return binary;\r\n    }\r\n    throw error;\r\n\r\n  }\r\n}\r\n\r\nfunction decodeJPEGBaseline8BitColor (imageFrame, pixelData, canvas) {\r\n  const start = new Date().getTime();\r\n  const deferred = $.Deferred();\r\n\r\n  const imgBlob = new Blob([pixelData], { type: 'image/jpeg' });\r\n\r\n  const r = new FileReader();\r\n\r\n  if (r.readAsBinaryString === undefined) {\r\n    r.readAsArrayBuffer(imgBlob);\r\n  } else {\r\n    r.readAsBinaryString(imgBlob); // doesn't work on IE11\r\n  }\r\n\r\n  r.onload = function () {\r\n    const img = new Image();\r\n\r\n    img.onload = function () {\r\n      canvas.height = img.height;\r\n      canvas.width = img.width;\r\n      imageFrame.rows = img.height;\r\n      imageFrame.columns = img.width;\r\n      const context = canvas.getContext('2d');\r\n\r\n      context.drawImage(this, 0, 0);\r\n      const imageData = context.getImageData(0, 0, img.width, img.height);\r\n      const end = new Date().getTime();\r\n\r\n      imageFrame.pixelData = imageData.data;\r\n      imageFrame.imageData = imageData;\r\n      imageFrame.decodeTimeInMS = end - start;\r\n      deferred.resolve(imageFrame);\r\n    };\r\n    img.onerror = function (error) {\r\n      deferred.reject(error);\r\n    };\r\n    if (r.readAsBinaryString === undefined) {\r\n      img.src = `data:image/jpeg;base64,${window.btoa(arrayBufferToString(r.result))}`;\r\n    } else {\r\n      img.src = `data:image/jpeg;base64,${window.btoa(r.result)}`; // doesn't work on IE11\r\n    }\r\n\r\n  };\r\n\r\n  return deferred.promise();\r\n}\r\n\r\nexport default decodeJPEGBaseline8BitColor;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/decodeJPEGBaseline8BitColor.js","const events = {\n  name: 'cornerstoneWADOImageLoader'\n};\n\nexport default events;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/events.js","import * as cornerstone from 'cornerstone-core';\r\n\r\nfunction getImageFrame (imageId) {\r\n  const imagePixelModule = cornerstone.metaData.get('imagePixelModule', imageId);\r\n\r\n  return {\r\n    samplesPerPixel: imagePixelModule.samplesPerPixel,\r\n    photometricInterpretation: imagePixelModule.photometricInterpretation,\r\n    planarConfiguration: imagePixelModule.planarConfiguration,\r\n    rows: imagePixelModule.rows,\r\n    columns: imagePixelModule.columns,\r\n    bitsAllocated: imagePixelModule.bitsAllocated,\r\n    pixelRepresentation: imagePixelModule.pixelRepresentation, // 0 = unsigned,\r\n    smallestPixelValue: imagePixelModule.smallestPixelValue,\r\n    largestPixelValue: imagePixelModule.largestPixelValue,\r\n    redPaletteColorLookupTableDescriptor: imagePixelModule.redPaletteColorLookupTableDescriptor,\r\n    greenPaletteColorLookupTableDescriptor: imagePixelModule.greenPaletteColorLookupTableDescriptor,\r\n    bluePaletteColorLookupTableDescriptor: imagePixelModule.bluePaletteColorLookupTableDescriptor,\r\n    redPaletteColorLookupTableData: imagePixelModule.redPaletteColorLookupTableData,\r\n    greenPaletteColorLookupTableData: imagePixelModule.greenPaletteColorLookupTableData,\r\n    bluePaletteColorLookupTableData: imagePixelModule.bluePaletteColorLookupTableData,\r\n    pixelData: undefined // populated later after decoding\r\n  };\r\n}\r\n\r\nexport default getImageFrame;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/getImageFrame.js","export default function getMinMax (storedPixelData) {\r\n  // we always calculate the min max values since they are not always\r\n  // present in DICOM and we don't want to trust them anyway as cornerstone\r\n  // depends on us providing reliable values for these\r\n  let min = storedPixelData[0];\r\n  let max = storedPixelData[0];\r\n  let storedPixel;\r\n  const numPixels = storedPixelData.length;\r\n\r\n  for (let index = 0; index < numPixels; index++) {\r\n    storedPixel = storedPixelData[index];\r\n    min = Math.min(min, storedPixel);\r\n    max = Math.max(max, storedPixel);\r\n  }\r\n\r\n  return {\r\n    min,\r\n    max\r\n  };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/getMinMax.js","export default function (photoMetricInterpretation) {\r\n  return (photoMetricInterpretation === 'RGB' ||\r\n    photoMetricInterpretation === 'PALETTE COLOR' ||\r\n    photoMetricInterpretation === 'YBR_FULL' ||\r\n    photoMetricInterpretation === 'YBR_FULL_422' ||\r\n    photoMetricInterpretation === 'YBR_PARTIAL_422' ||\r\n    photoMetricInterpretation === 'YBR_PARTIAL_420' ||\r\n    photoMetricInterpretation === 'YBR_RCT' ||\r\n    photoMetricInterpretation === 'YBR_ICT');\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/isColorImage.js","function isJPEGBaseline8BitColor (imageFrame, transferSyntax) {\r\n  transferSyntax = transferSyntax || imageFrame.transferSyntax;\r\n\r\n  if (imageFrame.bitsAllocated === 8 &&\r\n     transferSyntax === '1.2.840.10008.1.2.4.50' &&\r\n     (imageFrame.samplesPerPixel === 3 || imageFrame.samplesPerPixel === 4)) {\r\n    return true;\r\n  }\r\n}\r\n\r\nexport default isJPEGBaseline8BitColor;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/isJPEGBaseline8BitColor.js","import $ from 'jquery';\r\n\r\n// the taskId to assign to the next task added via addTask()\r\nlet nextTaskId = 0;\r\n\r\n// array of queued tasks sorted with highest priority task first\r\nconst tasks = [];\r\n\r\n// array of web workers to dispatch decode tasks to\r\nconst webWorkers = [];\r\n\r\nconst defaultConfig = {\r\n  maxWebWorkers: navigator.hardwareConcurrency || 1,\r\n  startWebWorkersOnDemand: true,\r\n  webWorkerPath: '../../dist/cornerstoneWADOImageLoaderWebWorker.js',\r\n  webWorkerTaskPaths: [],\r\n  taskConfiguration: {\r\n    decodeTask: {\r\n      loadCodecsOnStartup: true,\r\n      initializeCodecsOnStartup: false,\r\n      codecsPath: '../dist/cornerstoneWADOImageLoaderCodecs.js',\r\n      usePDFJS: false\r\n    }\r\n  }\r\n};\r\n\r\nlet config;\r\n\r\nconst statistics = {\r\n  maxWebWorkers: 0,\r\n  numWebWorkers: 0,\r\n  numTasksQueued: 0,\r\n  numTasksExecuting: 0,\r\n  numTasksCompleted: 0,\r\n  totalTaskTimeInMS: 0,\r\n  totalTimeDelayedInMS: 0\r\n};\r\n\r\n/**\r\n * Function to start a task on a web worker\r\n */\r\nfunction startTaskOnWebWorker () {\r\n  // return immediately if no decode tasks to do\r\n  if (!tasks.length) {\r\n    return;\r\n  }\r\n\r\n  // look for a web worker that is ready\r\n  for (let i = 0; i < webWorkers.length; i++) {\r\n    if (webWorkers[i].status === 'ready') {\r\n      // mark it as busy so tasks are not assigned to it\r\n      webWorkers[i].status = 'busy';\r\n\r\n      // get the highest priority task\r\n      const task = tasks.shift();\r\n\r\n      task.start = new Date().getTime();\r\n\r\n      // update stats with how long this task was delayed (waiting in queue)\r\n      const end = new Date().getTime();\r\n\r\n      statistics.totalTimeDelayedInMS += end - task.added;\r\n\r\n      // assign this task to this web worker and send the web worker\r\n      // a message to execute it\r\n      webWorkers[i].task = task;\r\n      webWorkers[i].worker.postMessage({\r\n        taskType: task.taskType,\r\n        workerIndex: i,\r\n        data: task.data\r\n      }, task.transferList);\r\n      statistics.numTasksExecuting++;\r\n\r\n      return;\r\n    }\r\n  }\r\n\r\n  // if no available web workers and we haven't started max web workers, start a new one\r\n  if (webWorkers.length < config.maxWebWorkers) {\r\n    spawnWebWorker();\r\n  }\r\n}\r\n\r\n/**\r\n * Function to handle a message from a web worker\r\n * @param msg\r\n */\r\nfunction handleMessageFromWorker (msg) {\r\n  // console.log('handleMessageFromWorker', msg.data);\r\n  if (msg.data.taskType === 'initialize') {\r\n    webWorkers[msg.data.workerIndex].status = 'ready';\r\n    startTaskOnWebWorker();\r\n  } else {\r\n    const start = webWorkers[msg.data.workerIndex].task.start;\r\n\r\n    webWorkers[msg.data.workerIndex].task.deferred.resolve(msg.data.result);\r\n    webWorkers[msg.data.workerIndex].task = undefined;\r\n\r\n    statistics.numTasksExecuting--;\r\n    webWorkers[msg.data.workerIndex].status = 'ready';\r\n    statistics.numTasksCompleted++;\r\n\r\n    const end = new Date().getTime();\r\n\r\n    statistics.totalTaskTimeInMS += end - start;\r\n\r\n    startTaskOnWebWorker();\r\n  }\r\n}\r\n\r\n/**\r\n * Spawns a new web worker\r\n */\r\nfunction spawnWebWorker () {\r\n  // prevent exceeding maxWebWorkers\r\n  if (webWorkers.length >= config.maxWebWorkers) {\r\n    return;\r\n  }\r\n\r\n  // spawn the webworker\r\n  const worker = new Worker(config.webWorkerPath);\r\n\r\n  webWorkers.push({\r\n    worker,\r\n    status: 'initializing'\r\n  });\r\n  worker.addEventListener('message', handleMessageFromWorker);\r\n  worker.postMessage({\r\n    taskType: 'initialize',\r\n    workerIndex: webWorkers.length - 1,\r\n    config\r\n  });\r\n}\r\n\r\n/**\r\n * Initialization function for the web worker manager - spawns web workers\r\n * @param configObject\r\n */\r\nfunction initialize (configObject) {\r\n  configObject = configObject || defaultConfig;\r\n\r\n  // prevent being initialized more than once\r\n  if (config) {\r\n    throw new Error('WebWorkerManager already initialized');\r\n  }\r\n\r\n  config = configObject;\r\n\r\n  config.maxWebWorkers = config.maxWebWorkers || (navigator.hardwareConcurrency || 1);\r\n\r\n  // Spawn new web workers\r\n  if (!config.startWebWorkersOnDemand) {\r\n    for (let i = 0; i < config.maxWebWorkers; i++) {\r\n      spawnWebWorker();\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * dynamically loads a web worker task\r\n * @param sourcePath\r\n * @param taskConfig\r\n */\r\nfunction loadWebWorkerTask (sourcePath, taskConfig) {\r\n  // add it to the list of web worker tasks paths so on demand web workers\r\n  // load this properly\r\n  config.webWorkerTaskPaths.push(sourcePath);\r\n\r\n  // if a task specific configuration is provided, merge it into the config\r\n  if (taskConfig) {\r\n    config.taskConfiguration = Object.assign(config.taskConfiguration, taskConfig);\r\n  }\r\n\r\n  // tell each spawned web worker to load this task\r\n  for (let i = 0; i < webWorkers.length; i++) {\r\n    webWorkers[i].worker.postMessage({\r\n      taskType: 'loadWebWorkerTask',\r\n      workerIndex: webWorkers.length - 1,\r\n      sourcePath,\r\n      config\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Function to add a decode task to be performed\r\n *\r\n * @param taskType - the taskType for this task\r\n * @param data - data specific to the task\r\n * @param priority - optional priority of the task (defaults to 0), > 0 is higher, < 0 is lower\r\n * @param transferList - optional array of data to transfer to web worker\r\n * @returns {*}\r\n */\r\nfunction addTask (taskType, data, priority = 0, transferList) {\r\n  if (!config) {\r\n    initialize();\r\n  }\r\n\r\n  const deferred = $.Deferred();\r\n\r\n  // find the right spot to insert this decode task (based on priority)\r\n  let i;\r\n\r\n  for (i = 0; i < tasks.length; i++) {\r\n    if (tasks[i].priority <= priority) {\r\n      break;\r\n    }\r\n  }\r\n\r\n  const taskId = nextTaskId++;\r\n\r\n  // insert the decode task at position i\r\n  tasks.splice(i, 0, {\r\n    taskId,\r\n    taskType,\r\n    status: 'ready',\r\n    added: new Date().getTime(),\r\n    data,\r\n    deferred,\r\n    priority,\r\n    transferList\r\n  });\r\n\r\n  // try to start a task on the web worker since we just added a new task and a web worker may be available\r\n  startTaskOnWebWorker();\r\n\r\n  return {\r\n    taskId,\r\n    promise: deferred.promise()\r\n  };\r\n}\r\n\r\n/**\r\n * Changes the priority of a queued task\r\n * @param taskId - the taskId to change the priority of\r\n * @param priority - priority of the task (defaults to 0), > 0 is higher, < 0 is lower\r\n * @returns boolean - true on success, false if taskId not found\r\n */\r\nfunction setTaskPriority (taskId, priority = 0) {\r\n  // search for this taskId\r\n  for (let i = 0; i < tasks.length; i++) {\r\n    if (tasks[i].taskId === taskId) {\r\n      // taskId found, remove it\r\n      const task = tasks.splice(i, 1)[0];\r\n\r\n      // set its priority\r\n      task.priority = priority;\r\n\r\n      // find the right spot to insert this decode task (based on priority)\r\n      for (i = 0; i < tasks.length; i++) {\r\n        if (tasks[i].priority <= priority) {\r\n          break;\r\n        }\r\n      }\r\n\r\n      // insert the decode task at position i\r\n      tasks.splice(i, 0, task);\r\n\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n/**\r\n * Cancels a queued task and rejects\r\n * @param taskId - the taskId to cancel\r\n * @param reason - optional reason the task was rejected\r\n * @returns boolean - true on success, false if taskId not found\r\n */\r\nfunction cancelTask (taskId, reason) {\r\n  // search for this taskId\r\n  for (let i = 0; i < tasks.length; i++) {\r\n    if (tasks[i].taskId === taskId) {\r\n      // taskId found, remove it\r\n      const task = tasks.splice(i, 1);\r\n\r\n      task.promise.reject(reason);\r\n\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n/**\r\n * Function to return the statistics on running web workers\r\n * @returns object containing statistics\r\n */\r\nfunction getStatistics () {\r\n  statistics.maxWebWorkers = config.maxWebWorkers;\r\n  statistics.numWebWorkers = webWorkers.length;\r\n  statistics.numTasksQueued = tasks.length;\r\n\r\n  return statistics;\r\n}\r\n\r\nexport default {\r\n  initialize,\r\n  loadWebWorkerTask,\r\n  addTask,\r\n  getStatistics,\r\n  setTaskPriority,\r\n  cancelTask\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/webWorkerManager.js","let options = {\r\n  // callback allowing customization of the xhr (e.g. adding custom auth headers, cors, etc)\r\n  beforeSend (/* xhr */) {\r\n  },\r\n  // callback allowing modification of newly created image objects\r\n  imageCreated (/* image */) {\r\n  }\r\n};\r\n\r\nexport function setOptions (newOptions) {\r\n  options = newOptions;\r\n}\r\n\r\nexport function getOptions () {\r\n  return options;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/internal/options.js","function checkToken (token, data, dataOffset) {\r\n\r\n  if (dataOffset + token.length > data.length) {\r\n    return false;\r\n  }\r\n\r\n  let endIndex = dataOffset;\r\n\r\n  for (let i = 0; i < token.length; i++) {\r\n    if (token[i] !== data[endIndex++]) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction stringToUint8Array (str) {\r\n  const uint = new Uint8Array(str.length);\r\n\r\n  for (let i = 0, j = str.length; i < j; i++) {\r\n    uint[i] = str.charCodeAt(i);\r\n  }\r\n\r\n  return uint;\r\n}\r\n\r\nfunction findIndexOfString (data, str, offset) {\r\n\r\n  offset = offset || 0;\r\n\r\n  const token = stringToUint8Array(str);\r\n\r\n  for (let i = offset; i < data.length; i++) {\r\n    if (token[0] === data[i]) {\r\n      // console.log('match @', i);\r\n      if (checkToken(token, data, i)) {\r\n        return i;\r\n      }\r\n    }\r\n  }\r\n\r\n  return -1;\r\n}\r\nexport default findIndexOfString;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/findIndexOfString.js","import $ from 'jquery';\r\nimport { xhrRequest } from '../internal';\r\nimport findIndexOfString from './findIndexOfString';\r\n\r\nfunction findBoundary (header) {\r\n  for (let i = 0; i < header.length; i++) {\r\n    if (header[i].substr(0, 2) === '--') {\r\n      return header[i];\r\n    }\r\n  }\r\n\r\n  return undefined;\r\n}\r\n\r\nfunction findContentType (header) {\r\n  for (let i = 0; i < header.length; i++) {\r\n    if (header[i].substr(0, 13) === 'Content-Type:') {\r\n      return header[i].substr(13).trim();\r\n    }\r\n  }\r\n\r\n  return undefined;\r\n}\r\n\r\nfunction uint8ArrayToString (data, offset, length) {\r\n  offset = offset || 0;\r\n  length = length || data.length - offset;\r\n  let str = '';\r\n\r\n  for (let i = offset; i < offset + length; i++) {\r\n    str += String.fromCharCode(data[i]);\r\n  }\r\n\r\n  return str;\r\n}\r\n\r\nfunction getPixelData (uri, imageId, mediaType) {\r\n  mediaType = mediaType || 'application/octet-stream';\r\n  const headers = {\r\n    accept: mediaType\r\n  };\r\n\r\n  const deferred = $.Deferred();\r\n\r\n  const loadPromise = xhrRequest(uri, imageId, headers);\r\n\r\n  loadPromise.then(function (imageFrameAsArrayBuffer/* , xhr*/) {\r\n\r\n    // request succeeded, Parse the multi-part mime response\r\n    const response = new Uint8Array(imageFrameAsArrayBuffer);\r\n\r\n    // First look for the multipart mime header\r\n    const tokenIndex = findIndexOfString(response, '\\r\\n\\r\\n');\r\n\r\n    if (tokenIndex === -1) {\r\n      deferred.reject('invalid response - no multipart mime header');\r\n    }\r\n    const header = uint8ArrayToString(response, 0, tokenIndex);\r\n    // Now find the boundary  marker\r\n    const split = header.split('\\r\\n');\r\n    const boundary = findBoundary(split);\r\n\r\n    if (!boundary) {\r\n      deferred.reject('invalid response - no boundary marker');\r\n    }\r\n    const offset = tokenIndex + 4; // skip over the \\r\\n\\r\\n\r\n\r\n    // find the terminal boundary marker\r\n    const endIndex = findIndexOfString(response, boundary, offset);\r\n\r\n    if (endIndex === -1) {\r\n      deferred.reject('invalid response - terminating boundary not found');\r\n    }\r\n\r\n    // Remove \\r\\n from the length\r\n    const length = endIndex - offset - 2;\r\n\r\n    // return the info for this pixel data\r\n    deferred.resolve({\r\n      contentType: findContentType(split),\r\n      imageFrame: {\r\n        pixelData: new Uint8Array(imageFrameAsArrayBuffer, offset, length)\r\n      }\r\n    });\r\n  });\r\n\r\n  return deferred.promise();\r\n}\r\n\r\nexport default getPixelData;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/getPixelData.js","import getValue from './getValue';\r\n\r\nfunction getNumberValue (element, index) {\r\n  const value = getValue(element, index);\r\n\r\n  if (value === undefined) {\r\n    return;\r\n  }\r\n\r\n  return parseFloat(value);\r\n}\r\n\r\nexport default getNumberValue;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getNumberValue.js","\r\n\r\n/**\r\n * Returns the values as an array of javascript numbers\r\n *\r\n * @param element - The javascript object for the specified element in the metadata\r\n * @param [minimumLength] - the minimum number of values\r\n * @returns {*}\r\n */\r\nfunction getNumberValues (element, minimumLength) {\r\n  if (!element) {\r\n    return;\r\n  }\r\n  // Value is not present if the attribute has a zero length value\r\n  if (!element.Value) {\r\n    return;\r\n  }\r\n  // make sure we have the expected length\r\n  if (minimumLength && element.Value.length < minimumLength) {\r\n    return;\r\n  }\r\n\r\n  const values = [];\r\n\r\n  for (let i = 0; i < element.Value.length; i++) {\r\n    values.push(parseFloat(element.Value[i]));\r\n  }\r\n\r\n  return values;\r\n}\r\n\r\nexport default getNumberValues;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getNumberValues.js","let files = [];\r\n\r\nfunction add (file) {\r\n  const fileIndex = files.push(file);\r\n\r\n  return `dicomfile:${fileIndex - 1}`;\r\n}\r\n\r\nfunction get (index) {\r\n  return files[index];\r\n}\r\n\r\nfunction remove (index) {\r\n  files[index] = undefined;\r\n}\r\n\r\nfunction purge () {\r\n  files = [];\r\n}\r\n\r\nexport default {\r\n  add,\r\n  get,\r\n  remove,\r\n  purge\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/fileManager.js","import * as dicomParser from 'dicom-parser';\r\n\r\n/**\r\n * Function to deal with extracting an image frame from an encapsulated data set.\r\n */\r\n\r\n\r\nfunction framesAreFragmented (dataSet) {\r\n  const numberOfFrames = dataSet.intString('x00280008');\r\n  const pixelDataElement = dataSet.elements.x7fe00010;\r\n\r\n  return (numberOfFrames !== pixelDataElement.fragments.length);\r\n}\r\n\r\nexport default function getEncapsulatedImageFrame (dataSet, frameIndex) {\r\n  if (dataSet.elements.x7fe00010.basicOffsetTable.length) {\r\n    // Basic Offset Table is not empty\r\n    return dicomParser.readEncapsulatedImageFrame(dataSet, dataSet.elements.x7fe00010, frameIndex);\r\n  }\r\n\r\n  // Empty basic offset table\r\n\r\n  if (framesAreFragmented(dataSet)) {\r\n    const basicOffsetTable = dicomParser.createJPEGBasicOffsetTable(dataSet, dataSet.elements.x7fe00010);\r\n\r\n    return dicomParser.readEncapsulatedImageFrame(dataSet, dataSet.elements.x7fe00010, frameIndex, basicOffsetTable);\r\n  }\r\n\r\n  return dicomParser.readEncapsulatedPixelDataFromFragments(dataSet, dataSet.elements.x7fe00010, frameIndex);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/getEncapsulatedImageFrame.js","import unpackBinaryFrame from './unpackBinaryFrame';\r\n\r\n/**\r\n * Function to deal with extracting an image frame from an encapsulated data set.\r\n */\r\n\r\nfunction getUncompressedImageFrame (dataSet, frameIndex) {\r\n  const pixelDataElement = dataSet.elements.x7fe00010;\r\n  const bitsAllocated = dataSet.uint16('x00280100');\r\n  const rows = dataSet.uint16('x00280010');\r\n  const columns = dataSet.uint16('x00280011');\r\n  const samplesPerPixel = dataSet.uint16('x00280002');\r\n\r\n  const pixelDataOffset = pixelDataElement.dataOffset;\r\n  const pixelsPerFrame = rows * columns * samplesPerPixel;\r\n\r\n  let frameOffset;\r\n\r\n  if (bitsAllocated === 8) {\r\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame;\r\n    if (frameOffset >= dataSet.byteArray.length) {\r\n      throw 'frame exceeds size of pixelData';\r\n    }\r\n\r\n    return new Uint8Array(dataSet.byteArray.buffer, frameOffset, pixelsPerFrame);\r\n  } else if (bitsAllocated === 16) {\r\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame * 2;\r\n    if (frameOffset >= dataSet.byteArray.length) {\r\n      throw 'frame exceeds size of pixelData';\r\n    }\r\n\r\n    return new Uint8Array(dataSet.byteArray.buffer, frameOffset, pixelsPerFrame * 2);\r\n  } else if (bitsAllocated === 1) {\r\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame * 0.125;\r\n    if (frameOffset >= dataSet.byteArray.length) {\r\n      throw 'frame exceeds size of pixelData';\r\n    }\r\n\r\n    return unpackBinaryFrame(dataSet.byteArray, frameOffset, pixelsPerFrame);\r\n  }\r\n\r\n  throw 'unsupported pixel format';\r\n}\r\n\r\nexport default getUncompressedImageFrame;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/getUncompressedImageFrame.js","import $ from 'jquery';\r\nimport parseImageId from './parseImageId';\r\nimport fileManager from './fileManager';\r\n\r\nfunction loadFileRequest (uri) {\r\n  const parsedImageId = parseImageId(uri);\r\n  const fileIndex = parseInt(parsedImageId.url, 10);\r\n  const file = fileManager.get(fileIndex);\r\n\r\n  // create a deferred object\r\n  const deferred = $.Deferred();\r\n\r\n  const fileReader = new FileReader();\r\n\r\n  fileReader.onload = function (e) {\r\n    const dicomPart10AsArrayBuffer = e.target.result;\r\n\r\n    deferred.resolve(dicomPart10AsArrayBuffer);\r\n  };\r\n  fileReader.readAsArrayBuffer(file);\r\n\r\n  return deferred.promise();\r\n}\r\n\r\nexport default loadFileRequest;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/loadFileRequest.js","\r\n\r\nfunction getLutDescriptor (dataSet, tag) {\r\n  if (!dataSet.elements[tag] || dataSet.elements[tag].length !== 6) {\r\n    return;\r\n  }\r\n\r\n  return [dataSet.uint16(tag, 0), dataSet.uint16(tag, 1), dataSet.uint16(tag, 2)];\r\n}\r\n\r\nfunction getLutData (lutDataSet, tag, lutDescriptor) {\r\n  const lut = [];\r\n  const lutData = lutDataSet.elements[tag];\r\n  const numLutEntries = lutDescriptor[0];\r\n\r\n  for (let i = 0; i < numLutEntries; i++) {\r\n    // Output range is always unsigned\r\n    if (lutDescriptor[2] === 16) {\r\n      lut[i] = lutDataSet.uint16(tag, i);\r\n    } else {\r\n      lut[i] = lutDataSet.byteArray[i + lutData.dataOffset];\r\n    }\r\n  }\r\n\r\n  return lut;\r\n}\r\n\r\nfunction populatePaletteColorLut (dataSet, imagePixelModule) {\r\n  // return immediately if no palette lut elements\r\n  if (!dataSet.elements.x00281101) {\r\n    return;\r\n  }\r\n  imagePixelModule.redPaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281101');\r\n  imagePixelModule.greenPaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281102');\r\n  imagePixelModule.bluePaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281103');\r\n\r\n  imagePixelModule.redPaletteColorLookupTableData = getLutData(dataSet, 'x00281201', imagePixelModule.redPaletteColorLookupTableDescriptor);\r\n  imagePixelModule.greenPaletteColorLookupTableData = getLutData(dataSet, 'x00281202', imagePixelModule.greenPaletteColorLookupTableDescriptor);\r\n  imagePixelModule.bluePaletteColorLookupTableData = getLutData(dataSet, 'x00281203', imagePixelModule.bluePaletteColorLookupTableDescriptor);\r\n}\r\n\r\nfunction populateSmallestLargestPixelValues (dataSet, imagePixelModule) {\r\n  const pixelRepresentation = dataSet.uint16('x00280103');\r\n\r\n  if (pixelRepresentation === 0) {\r\n    imagePixelModule.smallestPixelValue = dataSet.uint16('x00280106');\r\n    imagePixelModule.largestPixelValue = dataSet.uint16('x00280107');\r\n  } else {\r\n    imagePixelModule.smallestPixelValue = dataSet.int16('x00280106');\r\n    imagePixelModule.largestPixelValue = dataSet.int16('x00280107');\r\n  }\r\n}\r\n\r\nfunction getImagePixelModule (dataSet) {\r\n\r\n  const imagePixelModule = {\r\n    samplesPerPixel: dataSet.uint16('x00280002'),\r\n    photometricInterpretation: dataSet.string('x00280004'),\r\n    rows: dataSet.uint16('x00280010'),\r\n    columns: dataSet.uint16('x00280011'),\r\n    bitsAllocated: dataSet.uint16('x00280100'),\r\n    bitsStored: dataSet.uint16('x00280101'),\r\n    highBit: dataSet.uint16('x00280102'),\r\n    pixelRepresentation: dataSet.uint16('x00280103'),\r\n    planarConfiguration: dataSet.uint16('x00280006'),\r\n    pixelAspectRatio: dataSet.string('x00280034')\r\n  };\r\n\r\n  populateSmallestLargestPixelValues(dataSet, imagePixelModule);\r\n  populatePaletteColorLut(dataSet, imagePixelModule);\r\n\r\n  return imagePixelModule;\r\n\r\n}\r\n\r\nexport default getImagePixelModule;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getImagePixelModule.js","\r\n\r\nfunction getLUT (pixelRepresentation, lutDataSet) {\r\n  let numLUTEntries = lutDataSet.uint16('x00283002', 0);\r\n\r\n  if (numLUTEntries === 0) {\r\n    numLUTEntries = 65535;\r\n  }\r\n  let firstValueMapped = 0;\r\n\r\n  if (pixelRepresentation === 0) {\r\n    firstValueMapped = lutDataSet.uint16('x00283002', 1);\r\n  } else {\r\n    firstValueMapped = lutDataSet.int16('x00283002', 1);\r\n  }\r\n  const numBitsPerEntry = lutDataSet.uint16('x00283002', 2);\r\n  // console.log('LUT(', numLUTEntries, ',', firstValueMapped, ',', numBitsPerEntry, ')');\r\n  const lut = {\r\n    id: '1',\r\n    firstValueMapped,\r\n    numBitsPerEntry,\r\n    lut: []\r\n  };\r\n\r\n  // console.log(\"minValue=\", minValue, \"; maxValue=\", maxValue);\r\n  for (let i = 0; i < numLUTEntries; i++) {\r\n    if (pixelRepresentation === 0) {\r\n      lut.lut[i] = lutDataSet.uint16('x00283006', i);\r\n    } else {\r\n      lut.lut[i] = lutDataSet.int16('x00283006', i);\r\n    }\r\n  }\r\n\r\n  return lut;\r\n}\r\n\r\n\r\nfunction getLUTs (pixelRepresentation, lutSequence) {\r\n  if (!lutSequence || !lutSequence.items.length) {\r\n    return;\r\n  }\r\n  const luts = [];\r\n\r\n  for (let i = 0; i < lutSequence.items.length; i++) {\r\n    const lutDataSet = lutSequence.items[i].dataSet;\r\n    const lut = getLUT(pixelRepresentation, lutDataSet);\r\n\r\n    if (lut) {\r\n      luts.push(lut);\r\n    }\r\n  }\r\n\r\n  return luts;\r\n}\r\n\r\nexport default getLUTs;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getLUTs.js","/* eslint no-bitwise: 0 */\r\n\r\nfunction getMinStoredPixelValue (dataSet) {\r\n  const pixelRepresentation = dataSet.uint16('x00280103');\r\n  const bitsStored = dataSet.uint16('x00280101');\r\n\r\n  if (pixelRepresentation === 0) {\r\n    return 0;\r\n  }\r\n\r\n  return -1 << (bitsStored - 1);\r\n}\r\n\r\n// 0 = unsigned / US, 1 = signed / SS\r\nfunction getModalityLUTOutputPixelRepresentation (dataSet) {\r\n\r\n  // CT SOP Classes are always signed\r\n  const sopClassUID = dataSet.string('x00080016');\r\n\r\n  if (sopClassUID === '1.2.840.10008.5.1.4.1.1.2' ||\r\n    sopClassUID === '1.2.840.10008.5.1.4.1.1.2.1') {\r\n    return 1;\r\n  }\r\n\r\n  // if rescale intercept and rescale slope are present, pass the minimum stored\r\n  // pixel value through them to see if we get a signed output range\r\n  const rescaleIntercept = dataSet.floatString('x00281052');\r\n  const rescaleSlope = dataSet.floatString('x00281053');\r\n\r\n  if (rescaleIntercept !== undefined && rescaleSlope !== undefined) {\r\n    const minStoredPixelValue = getMinStoredPixelValue(dataSet); //\r\n    const minModalityLutValue = minStoredPixelValue * rescaleSlope + rescaleIntercept;\r\n\r\n    if (minModalityLutValue < 0) {\r\n      return 1;\r\n    }\r\n\r\n    return 0;\r\n\r\n  }\r\n\r\n  // Output of non linear modality lut is always unsigned\r\n  if (dataSet.elements.x00283000 && dataSet.elements.x00283000.length > 0) {\r\n    return 0;\r\n  }\r\n\r\n  // If no modality lut transform, output is same as pixel representation\r\n  return dataSet.uint16('x00280103');\r\n}\r\n\r\nexport default getModalityLUTOutputPixelRepresentation;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js","function getNumberValues (dataSet, tag, minimumLength) {\r\n  const values = [];\r\n  const valueAsString = dataSet.string(tag);\r\n\r\n  if (!valueAsString) {\r\n    return;\r\n  }\r\n  const split = valueAsString.split('\\\\');\r\n\r\n  if (minimumLength && split.length < minimumLength) {\r\n    return;\r\n  }\r\n  for (let i = 0; i < split.length; i++) {\r\n    values.push(parseFloat(split[i]));\r\n  }\r\n\r\n  return values;\r\n}\r\n\r\nexport default getNumberValues;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getNumberValues.js","/* eslint no-bitwise: 0 */\r\n\r\nfunction isBitSet (byte, bitPos) {\r\n  return byte & (1 << bitPos);\r\n}\r\n\r\n/**\r\n * Function to deal with unpacking a binary frame\r\n */\r\nfunction unpackBinaryFrame (byteArray, frameOffset, pixelsPerFrame) {\r\n  // Create a new pixel array given the image size\r\n  const pixelData = new Uint8Array(pixelsPerFrame);\r\n\r\n  for (let i = 0; i < pixelsPerFrame; i++) {\r\n    // Compute byte position\r\n    const bytePos = Math.floor(i / 8);\r\n\r\n    // Get the current byte\r\n    const byte = byteArray[bytePos + frameOffset];\r\n\r\n    // Bit position (0-7) within byte\r\n    const bitPos = (i % 8);\r\n\r\n    // Check whether bit at bitpos is set\r\n    pixelData[i] = isBitSet(byte, bitPos) ? 1 : 0;\r\n  }\r\n\r\n  return pixelData;\r\n}\r\n\r\nexport default unpackBinaryFrame;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/unpackBinaryFrame.js","import { setOptions } from './internal';\r\n\r\nfunction configure (options) {\r\n  setOptions(options);\r\n}\r\n\r\nexport default configure;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/configure.js","import { getNumberString,\r\n         getNumberValue,\r\n         getNumberValues,\r\n         getValue,\r\n         metaDataProvider } from './metaData';\r\n\r\nimport findIndexOfString from './findIndexOfString';\r\nimport getPixelData from './getPixelData';\r\nimport metaDataManager from './metaDataManager';\r\nimport loadImage from './loadImage';\r\n\r\nconst metaData = {\r\n  getNumberString,\r\n  getNumberValue,\r\n  getNumberValues,\r\n  getValue,\r\n  metaDataProvider\r\n};\r\n\r\nexport default {\r\n  metaData,\r\n  findIndexOfString,\r\n  getPixelData,\r\n  loadImage,\r\n  metaDataManager\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/index.js","import { getImagePixelModule,\r\n         getLUTs,\r\n         getModalityLUTOutputPixelRepresentation,\r\n         getNumberValues,\r\n         metaDataProvider } from './metaData';\r\n\r\nimport dataSetCacheManager from './dataSetCacheManager';\r\nimport fileManager from './fileManager';\r\nimport getEncapsulatedImageFrame from './getEncapsulatedImageFrame';\r\nimport getUncompressedImageFrame from './getUncompressedImageFrame';\r\nimport loadFileRequest from './loadFileRequest';\r\nimport loadImage from './loadImage';\r\nimport parseImageId from './parseImageId';\r\nimport unpackBinaryFrame from './unpackBinaryFrame';\r\n\r\nconst metaData = {\r\n  getImagePixelModule,\r\n  getLUTs,\r\n  getModalityLUTOutputPixelRepresentation,\r\n  getNumberValues,\r\n  metaDataProvider\r\n};\r\n\r\nexport default {\r\n  metaData,\r\n  dataSetCacheManager,\r\n  fileManager,\r\n  getEncapsulatedImageFrame,\r\n  getUncompressedImageFrame,\r\n  loadFileRequest,\r\n  loadImage,\r\n  parseImageId,\r\n  unpackBinaryFrame\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/index.js","/* eslint no-bitwise: 0 */\r\n\r\nexport default function (imageFrame, rgbaBuffer) {\r\n  const numPixels = imageFrame.columns * imageFrame.rows;\r\n  let palIndex = 0;\r\n  let rgbaIndex = 0;\r\n  const pixelData = imageFrame.pixelData;\r\n  const start = imageFrame.redPaletteColorLookupTableDescriptor[1];\r\n  const rData = imageFrame.redPaletteColorLookupTableData;\r\n  const gData = imageFrame.greenPaletteColorLookupTableData;\r\n  const bData = imageFrame.bluePaletteColorLookupTableData;\r\n  const shift = imageFrame.redPaletteColorLookupTableDescriptor[2] === 8 ? 0 : 8;\r\n  let len = imageFrame.redPaletteColorLookupTableData.length;\r\n\r\n  if (len === 0) {\r\n    len = 65535;\r\n  }\r\n\r\n  for (let i = 0; i < numPixels; ++i) {\r\n    let value = pixelData[palIndex++];\r\n\r\n    if (value < start) {\r\n      value = 0;\r\n    } else if (value > start + len - 1) {\r\n      value = len - 1;\r\n    } else {\r\n      value -= start;\r\n    }\r\n\r\n    rgbaBuffer[rgbaIndex++] = rData[value] >> shift;\r\n    rgbaBuffer[rgbaIndex++] = gData[value] >> shift;\r\n    rgbaBuffer[rgbaIndex++] = bData[value] >> shift;\r\n    rgbaBuffer[rgbaIndex++] = 255;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js","export default function (imageFrame, rgbaBuffer) {\r\n  if (imageFrame === undefined) {\r\n    throw new Error('decodeRGB: rgbBuffer must not be undefined');\r\n  }\r\n  if (imageFrame.length % 3 !== 0) {\r\n    throw new Error('decodeRGB: rgbBuffer length must be divisible by 3');\r\n  }\r\n\r\n  const numPixels = imageFrame.length / 3;\r\n  let rgbIndex = 0;\r\n  let rgbaIndex = 0;\r\n\r\n  for (let i = 0; i < numPixels; i++) {\r\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // red\r\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // green\r\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // blue\r\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js","export default function (imageFrame, rgbaBuffer) {\r\n  if (imageFrame === undefined) {\r\n    throw new Error('decodeRGB: rgbBuffer must not be undefined');\r\n  }\r\n  if (imageFrame.length % 3 !== 0) {\r\n    throw new Error('decodeRGB: rgbBuffer length must be divisible by 3');\r\n  }\r\n\r\n  const numPixels = imageFrame.length / 3;\r\n  let rgbaIndex = 0;\r\n  let rIndex = 0;\r\n  let gIndex = numPixels;\r\n  let bIndex = numPixels * 2;\r\n\r\n  for (let i = 0; i < numPixels; i++) {\r\n    rgbaBuffer[rgbaIndex++] = imageFrame[rIndex++]; // red\r\n    rgbaBuffer[rgbaIndex++] = imageFrame[gIndex++]; // green\r\n    rgbaBuffer[rgbaIndex++] = imageFrame[bIndex++]; // blue\r\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js","export default function (imageFrame, rgbaBuffer) {\r\n  if (imageFrame === undefined) {\r\n    throw new Error('decodeRGB: ybrBuffer must not be undefined');\r\n  }\r\n  if (imageFrame.length % 3 !== 0) {\r\n    throw new Error('decodeRGB: ybrBuffer length must be divisble by 3');\r\n  }\r\n\r\n  const numPixels = imageFrame.length / 3;\r\n  let ybrIndex = 0;\r\n  let rgbaIndex = 0;\r\n\r\n  for (let i = 0; i < numPixels; i++) {\r\n    const y = imageFrame[ybrIndex++];\r\n    const cb = imageFrame[ybrIndex++];\r\n    const cr = imageFrame[ybrIndex++];\r\n\r\n    rgbaBuffer[rgbaIndex++] = y + 1.40200 * (cr - 128);// red\r\n    rgbaBuffer[rgbaIndex++] = y - 0.34414 * (cb - 128) - 0.71414 * (cr - 128); // green\r\n    rgbaBuffer[rgbaIndex++] = y + 1.77200 * (cb - 128); // blue\r\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js","export default function (imageFrame, rgbaBuffer) {\r\n  if (imageFrame === undefined) {\r\n    throw new Error('decodeRGB: ybrBuffer must not be undefined');\r\n  }\r\n  if (imageFrame.length % 3 !== 0) {\r\n    throw new Error('decodeRGB: ybrBuffer length must be divisble by 3');\r\n  }\r\n\r\n  const numPixels = imageFrame.length / 3;\r\n  let rgbaIndex = 0;\r\n  let yIndex = 0;\r\n  let cbIndex = numPixels;\r\n  let crIndex = numPixels * 2;\r\n\r\n  for (let i = 0; i < numPixels; i++) {\r\n    const y = imageFrame[yIndex++];\r\n    const cb = imageFrame[cbIndex++];\r\n    const cr = imageFrame[crIndex++];\r\n\r\n    rgbaBuffer[rgbaIndex++] = y + 1.40200 * (cr - 128);// red\r\n    rgbaBuffer[rgbaIndex++] = y - 0.34414 * (cb - 128) - 0.71414 * (cr - 128); // green\r\n    rgbaBuffer[rgbaIndex++] = y + 1.77200 * (cb - 128); // blue\r\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js","export * from './colorSpaceConverters';\n\nexport { default as wadouri } from './wadouri';\nexport { default as wadors } from './wadors';\nexport { default as configure } from './configure';\nexport { default as convertColorSpace } from './convertColorSpace';\nexport { default as createImage } from './createImage';\nexport { default as decodeImageFrame } from './decodeImageFrame';\nexport { default as decodeJPEGBaseline8BitColor } from './decodeJPEGBaseline8BitColor';\nexport { default as getImageFrame } from './getImageFrame';\nexport { default as getMinMax } from './getMinMax';\nexport { default as isColorImage } from './isColorImage';\nexport { default as isJPEGBaseline8BitColor } from './isJPEGBaseline8BitColor';\nexport { default as webWorkerManager } from './webWorkerManager';\nexport { default as version } from '../version';\nexport { internal } from './internal/';\n\nexport { default as events } from './events.js';\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/index.js","import $ from 'jquery';\r\nimport { getOptions } from './options';\r\nimport * as cornerstone from 'cornerstone-core';\r\n\r\nfunction xhrRequest (url, imageId, headers = {}) {\r\n  const deferred = $.Deferred();\r\n  const options = getOptions();\r\n\r\n  // Make the request for the DICOM P10 SOP Instance\r\n  const xhr = new XMLHttpRequest();\r\n\r\n  xhr.open('get', url, true);\r\n  xhr.responseType = 'arraybuffer';\r\n  options.beforeSend(xhr);\r\n  Object.keys(headers).forEach(function (key) {\r\n    xhr.setRequestHeader(key, headers[key]);\r\n  });\r\n\r\n  // handle response data\r\n  xhr.onreadystatechange = function () {\r\n    // TODO: consider sending out progress messages here as we receive the pixel data\r\n    if (xhr.readyState === 4) {\r\n      if (xhr.status === 200) {\r\n        deferred.resolve(xhr.response, xhr);\r\n      } else {\r\n        // request failed, reject the deferred\r\n        deferred.reject(xhr);\r\n      }\r\n    }\r\n  };\r\n  xhr.onprogress = function (oProgress) {\r\n    // console.log('progress:',oProgress)\r\n\r\n    if (oProgress.lengthComputable) {  // evt.loaded the bytes browser receive\r\n      // evt.total the total bytes seted by the header\r\n      //\r\n      const loaded = oProgress.loaded;\r\n      const total = oProgress.total;\r\n      const percentComplete = Math.round((loaded / total) * 100);\r\n\r\n      $(cornerstone.events).trigger('CornerstoneImageLoadProgress', {\r\n        imageId,\r\n        loaded,\r\n        total,\r\n        percentComplete\r\n      });\r\n    }\r\n  };\r\n\r\n  xhr.send();\r\n\r\n  return deferred.promise();\r\n}\r\n\r\nexport default xhrRequest;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/internal/xhrRequest.js","import $ from 'jquery';\r\nimport * as cornerstone from 'cornerstone-core';\r\nimport metaDataManager from './metaDataManager';\r\nimport getPixelData from './getPixelData';\r\nimport createImage from '../createImage';\r\n\r\nfunction getTransferSyntaxForContentType (/* contentType */) {\r\n  return '1.2.840.10008.1.2'; // hard code to ILE for now\r\n}\r\n\r\nfunction loadImage (imageId, options) {\r\n  const start = new Date().getTime();\r\n\r\n  const deferred = $.Deferred();\r\n\r\n  const uri = imageId.substring(7);\r\n\r\n  // check to make sure we have metadata for this imageId\r\n  const metaData = metaDataManager.get(imageId);\r\n\r\n  if (metaData === undefined) {\r\n    deferred.reject(`no metadata for imageId ${imageId}`);\r\n\r\n    return deferred.promise();\r\n  }\r\n\r\n  // TODO: load bulk data items that we might need\r\n\r\n  const mediaType = 'multipart/related; type=\"application/octet-stream\"'; // 'image/dicom+jp2';\r\n\r\n  // get the pixel data from the server\r\n  getPixelData(uri, imageId, mediaType).then(function (result) {\r\n\r\n    const transferSyntax = getTransferSyntaxForContentType(result.contentType);\r\n    const pixelData = result.imageFrame.pixelData;\r\n    const imagePromise = createImage(imageId, pixelData, transferSyntax, options);\r\n\r\n    imagePromise.then(function (image) {\r\n      // add the loadTimeInMS property\r\n      const end = new Date().getTime();\r\n\r\n      image.loadTimeInMS = end - start;\r\n      deferred.resolve(image);\r\n    });\r\n  }).fail(function (reason) {\r\n    deferred.reject(reason);\r\n  });\r\n\r\n  return deferred;\r\n}\r\n\r\n// register wadors scheme\r\ncornerstone.registerImageLoader('wadors', loadImage);\r\n\r\nexport default loadImage;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/loadImage.js","import getValue from './getValue';\r\n\r\n/**\r\n * Returns the first string value as a Javascript number\r\n *\r\n * @param element - The javascript object for the specified element in the metadata\r\n * @param [index] - the index of the value in a multi-valued element, default is 0\r\n * @param [defaultValue] - The default value to return if the element does not exist\r\n * @returns {*}\r\n */\r\nfunction getNumberString (element, index, defaultValue) {\r\n  const value = getValue(element, index, defaultValue);\r\n\r\n  if (value === undefined) {\r\n    return;\r\n  }\r\n\r\n  return parseFloat(value);\r\n}\r\n\r\nexport default getNumberString;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getNumberString.js","export { default as getNumberString } from './getNumberString';\r\nexport { default as getNumberValue } from './getNumberValue';\r\nexport { default as getNumberValues } from './getNumberValues';\r\nexport { default as getValue } from './getValue';\r\nexport { default as metaDataProvider } from './metaDataProvider';\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/index.js","import getNumberValues from './getNumberValues';\r\nimport getValue from './getValue';\r\nimport getNumberValue from './getNumberValue';\r\nimport metaDataManager from '../metaDataManager';\r\nimport * as dicomParser from 'dicom-parser';\r\nimport * as cornerstone from 'cornerstone-core';\r\n\r\nfunction metaDataProvider (type, imageId) {\r\n  const metaData = metaDataManager.get(imageId);\r\n\r\n  if (!metaData) {\r\n    return;\r\n  }\r\n\r\n  if (type === 'generalSeriesModule') {\r\n    return {\r\n      modality: getValue(metaData['00080060']),\r\n      seriesInstanceUID: getValue(metaData['0020000e']),\r\n      seriesNumber: getNumberValue(metaData['00200011']),\r\n      studyInstanceUID: getValue(metaData['0020000d']),\r\n      seriesDate: dicomParser.parseDA(getValue(metaData['00080021'])),\r\n      seriesTime: dicomParser.parseTM(getValue(metaData['00080031'], 0, ''))\r\n    };\r\n  }\r\n\r\n  if (type === 'patientStudyModule') {\r\n    return {\r\n      patientAge: getNumberValue(metaData['00101010']),\r\n      patientSize: getNumberValue(metaData['00101020']),\r\n      patientWeight: getNumberValue(metaData['00101030'])\r\n    };\r\n  }\r\n\r\n  if (type === 'imagePlaneModule') {\r\n    return {\r\n      pixelSpacing: getNumberValues(metaData['00280030'], 2),\r\n      imageOrientationPatient: getNumberValues(metaData['00200037'], 6),\r\n      imagePositionPatient: getNumberValues(metaData['00200032'], 3),\r\n      sliceThickness: getNumberValue(metaData['00180050']),\r\n      sliceLocation: getNumberValue(metaData['00201041'])\r\n    };\r\n  }\r\n\r\n  if (type === 'imagePixelModule') {\r\n    return {\r\n      samplesPerPixel: getNumberValue(metaData['00280002']),\r\n      photometricInterpretation: getValue(metaData['00280004']),\r\n      rows: getNumberValue(metaData['00280010']),\r\n      columns: getNumberValue(metaData['00280011']),\r\n      bitsAllocated: getNumberValue(metaData['00280100']),\r\n      bitsStored: getNumberValue(metaData['00280101']),\r\n      highBit: getValue(metaData['00280102']),\r\n      pixelRepresentation: getNumberValue(metaData['00280103']),\r\n      planarConfiguration: getNumberValue(metaData['00280006']),\r\n      pixelAspectRatio: getValue(metaData['00280034']),\r\n      smallestPixelValue: getNumberValue(metaData['00280106']),\r\n      largestPixelValue: getNumberValue(metaData['00280107']),\r\n      redPaletteColorLookupTableDescriptor: getNumberValues(metaData['00281101']),\r\n      greenPaletteColorLookupTableDescriptor: getNumberValues(metaData['00281102']),\r\n      bluePaletteColorLookupTableDescriptor: getNumberValues(metaData['00281103']),\r\n      redPaletteColorLookupTableData: getNumberValues(metaData['00281201']),\r\n      greenPaletteColorLookupTableData: getNumberValues(metaData['00281202']),\r\n      bluePaletteColorLookupTableData: getNumberValues(metaData['00281203'])\r\n    };\r\n  }\r\n\r\n  if (type === 'voiLutModule') {\r\n    return {\r\n      // TODO VOT LUT Sequence\r\n      windowCenter: getNumberValues(metaData['00281050'], 1),\r\n      windowWidth: getNumberValues(metaData['00281051'], 1)\r\n    };\r\n  }\r\n\r\n  if (type === 'modalityLutModule') {\r\n    return {\r\n      // TODO VOT LUT Sequence\r\n      rescaleIntercept: getNumberValue(metaData['00281052']),\r\n      rescaleSlope: getNumberValue(metaData['00281053']),\r\n      rescaleType: getValue(metaData['00281054'])\r\n    };\r\n  }\r\n\r\n  if (type === 'sopCommonModule') {\r\n    return {\r\n      sopClassUID: getValue(metaData['00080016']),\r\n      sopInstanceUID: getValue(metaData['00080018'])\r\n    };\r\n  }\r\n\r\n  if (type === 'petIsotopeModule') {\r\n    const radiopharmaceuticalInfo = getValue(metaData['00540016']);\r\n\r\n    if (radiopharmaceuticalInfo === undefined) {\r\n      return;\r\n    }\r\n\r\n    return {\r\n      radiopharmaceuticalInfo: {\r\n        radiopharmaceuticalStartTime: dicomParser.parseTM(getValue(radiopharmaceuticalInfo['00181072'], 0, '')),\r\n        radionuclideTotalDose: getNumberValue(radiopharmaceuticalInfo['00181074']),\r\n        radionuclideHalfLife: getNumberValue(radiopharmaceuticalInfo['00181075'])\r\n      }\r\n    };\r\n  }\r\n\r\n}\r\n\r\ncornerstone.metaData.addProvider(metaDataProvider);\r\n\r\nexport default metaDataProvider;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/metaDataProvider.js","import $ from 'jquery';\r\nimport * as cornerstone from 'cornerstone-core';\r\nimport createImage from '../createImage';\r\nimport parseImageId from './parseImageId';\r\nimport dataSetCacheManager from './dataSetCacheManager';\r\nimport getEncapsulatedImageFrame from './getEncapsulatedImageFrame';\r\nimport getUncompressedImageFrame from './getUncompressedImageFrame';\r\nimport loadFileRequest from './loadFileRequest';\r\nimport { xhrRequest } from '../internal';\r\n\r\n// add a decache callback function to clear out our dataSetCacheManager\r\nfunction addDecache (image) {\r\n  image.decache = function () {\r\n    // console.log('decache');\r\n    const parsedImageId = parseImageId(image.imageId);\r\n\r\n    dataSetCacheManager.unload(parsedImageId.url);\r\n  };\r\n}\r\n\r\nfunction getPixelData (dataSet, frameIndex) {\r\n  const pixelDataElement = dataSet.elements.x7fe00010;\r\n\r\n  if (pixelDataElement.encapsulatedPixelData) {\r\n    return getEncapsulatedImageFrame(dataSet, frameIndex);\r\n  }\r\n\r\n  return getUncompressedImageFrame(dataSet, frameIndex);\r\n\r\n}\r\n\r\nfunction loadImageFromPromise (dataSetPromise, imageId, frame, sharedCacheKey, options) {\r\n\r\n  const start = new Date().getTime();\r\n\r\n  frame = frame || 0;\r\n  const deferred = $.Deferred();\r\n\r\n  dataSetPromise.then(function (dataSet/* , xhr*/) {\r\n    const pixelData = getPixelData(dataSet, frame);\r\n    const transferSyntax = dataSet.string('x00020010');\r\n    const loadEnd = new Date().getTime();\r\n    const imagePromise = createImage(imageId, pixelData, transferSyntax, options);\r\n\r\n    imagePromise.then(function (image) {\r\n      image.data = dataSet;\r\n      const end = new Date().getTime();\r\n\r\n      image.loadTimeInMS = loadEnd - start;\r\n      image.totalTimeInMS = end - start;\r\n      addDecache(image);\r\n      deferred.resolve(image);\r\n    });\r\n  }, function (error) {\r\n    deferred.reject(error);\r\n  });\r\n\r\n  return deferred;\r\n}\r\n\r\nfunction getLoaderForScheme (scheme) {\r\n  if (scheme === 'dicomweb' || scheme === 'wadouri') {\r\n    return xhrRequest;\r\n  } else if (scheme === 'dicomfile') {\r\n    return loadFileRequest;\r\n  }\r\n}\r\n\r\nfunction loadImage (imageId, options) {\r\n  const parsedImageId = parseImageId(imageId);\r\n  const loader = getLoaderForScheme(parsedImageId.scheme);\r\n\r\n  // if the dataset for this url is already loaded, use it\r\n  if (dataSetCacheManager.isLoaded(parsedImageId.url)) {\r\n    return loadImageFromPromise(dataSetCacheManager.load(parsedImageId.url, loader, imageId), imageId, parsedImageId.frame, parsedImageId.url, options);\r\n  }\r\n\r\n  // load the dataSet via the dataSetCacheManager\r\n  return loadImageFromPromise(dataSetCacheManager.load(parsedImageId.url, loader, imageId), imageId, parsedImageId.frame, parsedImageId.url, options);\r\n}\r\n\r\n// register dicomweb and wadouri image loader prefixes\r\ncornerstone.registerImageLoader('dicomweb', loadImage);\r\ncornerstone.registerImageLoader('wadouri', loadImage);\r\ncornerstone.registerImageLoader('dicomfile', loadImage);\r\n\r\nexport default loadImage;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/loadImage.js","export { default as getImagePixelModule } from './getImagePixelModule';\r\nexport { default as getLUTs } from './getLUTs';\r\nexport { default as getModalityLUTOutputPixelRepresentation } from './getModalityLUTOutputPixelRepresentation';\r\nexport { default as getNumberValues } from './getNumberValues';\r\nexport { default as metaDataProvider } from './metaDataProvider';\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/index.js","import getNumberValues from './getNumberValues';\r\nimport parseImageId from '../parseImageId';\r\nimport dataSetCacheManager from '../dataSetCacheManager';\r\nimport getImagePixelModule from './getImagePixelModule';\r\nimport getLUTs from './getLUTs';\r\nimport getModalityLUTOutputPixelRepresentation from './getModalityLUTOutputPixelRepresentation';\r\nimport * as dicomParser from 'dicom-parser';\r\nimport * as cornerstone from 'cornerstone-core';\r\n\r\nfunction metaDataProvider (type, imageId) {\r\n  const parsedImageId = parseImageId(imageId);\r\n\r\n  const dataSet = dataSetCacheManager.get(parsedImageId.url);\r\n\r\n  if (!dataSet) {\r\n    return;\r\n  }\r\n\r\n  if (type === 'generalSeriesModule') {\r\n    return {\r\n      modality: dataSet.string('x00080060'),\r\n      seriesInstanceUID: dataSet.string('x0020000e'),\r\n      seriesNumber: dataSet.intString('x00200011'),\r\n      studyInstanceUID: dataSet.string('x0020000d'),\r\n      seriesDate: dicomParser.parseDA(dataSet.string('x00080021')),\r\n      seriesTime: dicomParser.parseTM(dataSet.string('x00080031') || '')\r\n    };\r\n  }\r\n\r\n  if (type === 'patientStudyModule') {\r\n    return {\r\n      patientAge: dataSet.intString('x00101010'),\r\n      patientSize: dataSet.floatString('x00101020'),\r\n      patientWeight: dataSet.floatString('x00101030')\r\n    };\r\n  }\r\n\r\n  if (type === 'imagePlaneModule') {\r\n    return {\r\n      pixelSpacing: getNumberValues(dataSet, 'x00280030', 2),\r\n      imageOrientationPatient: getNumberValues(dataSet, 'x00200037', 6),\r\n      imagePositionPatient: getNumberValues(dataSet, 'x00200032', 3),\r\n      sliceThickness: dataSet.floatString('x00180050'),\r\n      sliceLocation: dataSet.floatString('x00201041'),\r\n      frameOfReferenceUID: dataSet.string('x00200052')\r\n    };\r\n  }\r\n\r\n  if (type === 'imagePixelModule') {\r\n    return getImagePixelModule(dataSet);\r\n  }\r\n\r\n  if (type === 'modalityLutModule') {\r\n    return {\r\n      rescaleIntercept: dataSet.floatString('x00281052'),\r\n      rescaleSlope: dataSet.floatString('x00281053'),\r\n      rescaleType: dataSet.string('x00281054'),\r\n      modalityLUTSequence: getLUTs(dataSet.uint16('x00280103'), dataSet.elements.x00283000)\r\n    };\r\n  }\r\n\r\n  if (type === 'voiLutModule') {\r\n    const modalityLUTOutputPixelRepresentation = getModalityLUTOutputPixelRepresentation(dataSet);\r\n\r\n\r\n    return {\r\n      windowCenter: getNumberValues(dataSet, 'x00281050', 1),\r\n      windowWidth: getNumberValues(dataSet, 'x00281051', 1),\r\n      voiLUTSequence: getLUTs(modalityLUTOutputPixelRepresentation, dataSet.elements.x00283010)\r\n    };\r\n  }\r\n\r\n  if (type === 'sopCommonModule') {\r\n    return {\r\n      sopClassUID: dataSet.string('x00080016'),\r\n      sopInstanceUID: dataSet.string('x00080018')\r\n    };\r\n  }\r\n\r\n  if (type === 'petIsotopeModule') {\r\n    const radiopharmaceuticalInfo = dataSet.elements.x00540016;\r\n\r\n    if (radiopharmaceuticalInfo === undefined) {\r\n      return;\r\n    }\r\n\r\n    const firstRadiopharmaceuticalInfoDataSet = radiopharmaceuticalInfo.items[0].dataSet;\r\n\r\n\r\n    return {\r\n      radiopharmaceuticalInfo: {\r\n        radiopharmaceuticalStartTime: dicomParser.parseTM(firstRadiopharmaceuticalInfoDataSet.string('x00181072') || ''),\r\n        radionuclideTotalDose: firstRadiopharmaceuticalInfoDataSet.floatString('x00181074'),\r\n        radionuclideHalfLife: firstRadiopharmaceuticalInfoDataSet.floatString('x00181075')\r\n      }\r\n    };\r\n  }\r\n\r\n}\r\n\r\n// register our metadata provider\r\ncornerstone.metaData.addProvider(metaDataProvider);\r\n\r\nexport default metaDataProvider;\r\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/metaDataProvider.js"],"sourceRoot":""}